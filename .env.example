# ============================================
# CHAT APP BACKEND - ENVIRONMENT VARIABLES
# ============================================
# Copy this file and fill in the actual values
# All marked as REQUIRED must be set for full functionality

# ============================================
# DATABASE (PostgreSQL) - REQUIRED
# ============================================
# For Railway PostgreSQL:
# 1. Go to Railway Dashboard → PostgreSQL service
# 2. Click "Variables" tab
# 3. Copy the DATABASE_URL value
# 4. Paste it here exactly

DATABASE_URL=postgresql://postgres:your_password@containers.railway.internal:5432/railway

# ============================================
# JWT AUTHENTICATION - REQUIRED
# ============================================
# Generate with: openssl rand -hex 32
# Or: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# NEVER commit the real secret to git!

JWT_SECRET=your_very_secret_jwt_key_32_characters_minimum_do_not_expose

# ============================================
# EMAIL SERVICE (Brevo SMTP) - REQUIRED
# ============================================
# Instructions:
# 1. Sign up at https://www.brevo.com/
# 2. Go to Settings → SMTP & API
# 3. Create an SMTP key
# 4. Get your SMTP credentials from dashboard

SMTP_HOST=smtp-relay.brevo.com
SMTP_PORT=587
SMTP_USER=your_brevo_email@example.com
SMTP_PASSWORD=your_brevo_smtp_api_key
SMTP_FROM_EMAIL=noreply@yourapp.com
SMTP_FROM_NAME=YourAppName

# ============================================
# SERVER CONFIGURATION - OPTIONAL
# ============================================
# Production or development mode
NODE_ENV=production

# Port (Railway sets this automatically as 8080)
# For local development, use 3000
PORT=3000

# Application name (shown in emails)
APP_NAME=ChatApp

# App URL (for emails, redirects, etc)
APP_URL=https://your-app.railway.app

# ============================================
# OTP (One-Time Password) CONFIGURATION
# ============================================
# Customize OTP behavior (optional, has defaults)

# How long OTP is valid (in minutes)
OTP_EXPIRY_MINUTES=15

# How long user must wait before requesting new OTP (in minutes)
OTP_RESEND_COOLDOWN_MINUTES=5

# Maximum OTP attempts before blocking the user
OTP_MAX_ATTEMPTS=5

# ============================================
# CORS & SECURITY - OPTIONAL
# ============================================
# Comma-separated list of allowed origins
# For development: http://localhost:3000,http://localhost:8080
# For production: https://yourdomain.com,https://app.yourdomain.com

ALLOWED_ORIGINS=https://your-frontend.com,https://your-app.railway.app

# ============================================
# LOGGING - OPTIONAL
# ============================================
# Log level: error, warn, info, debug
LOG_LEVEL=info

# ============================================
# QUICK START FOR RAILWAY
# ============================================
# 1. Set DATABASE_URL (from PostgreSQL service)
# 2. Generate JWT_SECRET (use openssl command above)
# 3. Set SMTP credentials (from Brevo dashboard)
# 4. Set NODE_ENV=production
# 5. Copy all values to Railway Variables
# 6. Redeploy

# ============================================
# TROUBLESHOOTING
# ============================================
# DATABASE_URL not working?
# - Verify PostgreSQL service is running (green status)
# - Check the connection string format:
#   ✅ postgresql://user:pass@containers.railway.internal:5432/db
#   ❌ DO NOT use localhost (Railway internal only)
#   ❌ DO NOT use external host (won't work from Railway)

# SMTP not working?
# - Verify Brevo API key is correct
# - Check SMTP credentials in Brevo dashboard
# - Test with: https://your-app.railway.app/diagnostics

# Connection timeout?
# - Verify DATABASE_URL is set in Railway variables (not in .env)
# - Verify PostgreSQL service is running
# - Check Railway logs for detailed error messages

# ============================================
# SECURITY NOTES
# ============================================
# 1. NEVER commit real secrets to git
# 2. Always use environment variables in production
# 3. Rotate JWT_SECRET periodically
# 4. Regenerate SMTP_PASSWORD if exposed
# 5. Use strong passwords for DATABASE_URL
# 6. Don't log sensitive data (app sanitizes automatically)
